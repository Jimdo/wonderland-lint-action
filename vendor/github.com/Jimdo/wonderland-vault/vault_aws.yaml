---
keys:

  - key: aws/roles/deployer
    values:
      policy: |
        {
          "Version": "2012-10-17",
          "Statement": {
            "Effect": "Allow",
            "Action": "iam:*",
            "Resource": "*"
          }
        }

  - key: aws/roles/wonderland-service-pricing
    values:
      policy: |
        {
          "Version": "2012-10-17",
          "Statement": [
            {
              "Action": [
                "autoscaling:DescribeAutoScalingGroups",
                "autoscaling:DescribeLaunchConfigurations"
              ],
              "Effect": "Allow",
              "Resource": "*"
            }
          ]
        }

  - key: aws/roles/wonderland-instance-lifetime
    values:
      policy: |
        {
          "Version": "2012-10-17",
          "Statement": [
            {
              "Action": [
                "ec2:DescribeInstances"
              ],
              "Effect": "Allow",
              "Resource": "*"
            }
          ]
        }

  - key: aws/roles/wonderland-ecs-metadata
    values:
      policy: |
        {
          "Version": "2012-10-17",
          "Statement": [
            {
              "Action": [
                "ecs:Describe*",
                "ecs:List*",
                "sqs:ReceiveMessage",
                "sqs:DeleteMessage"
              ],
              "Effect": "Allow",
              "Resource": "*"
            }
          ]
        }

  - key: aws/roles/wonderland-ecs-prometheus
    values:
      policy: |
        {
          "Version": "2012-10-17",
          "Statement": [
            {
              "Action": [
                "ecs:Describe*",
                "ecs:List*"
              ],
              "Effect": "Allow",
              "Resource": "*"
            }
          ]
        }

  - key: aws/roles/wonderland-ecs-oom-notifications
    values:
      policy: |
        {
          "Version": "2012-10-17",
          "Statement": [
            {
              "Action": [
                "sqs:ReceiveMessage",
                "sqs:DeleteMessage"
              ],
              "Effect": "Allow",
              "Resource": "*"
            }
          ]
        }

  - key: aws/roles/wonderland-elb-prometheus
    values:
      policy: |
        {
          "Version": "2012-10-17",
          "Statement": [
            {
              "Action": [
                "cloudwatch:GetMetricStatistics",
                "cloudwatch:ListMetrics",
                "elasticloadbalancing:DescribeLoadBalancers"
              ],
              "Effect": "Allow",
              "Resource": "*"
            }
          ]
        }

  - key: aws/roles/wonderland-crons
    values:
      policy: |
        {
          "Version": "2012-10-17",
          "Statement": [
            {
              "Action": [
                "events:ListTargetsByRule",
                "events:*Rule",
                "events:*Targets",
                "ecs:*TaskDefinition",
                "ecs:ListTaskDefinitions",
                "iam:PassRole"
              ],
              "Effect": "Allow",
              "Resource": "*"
            },
            {
              "Action": [
                "dynamodb:*"
              ],
              "Effect": "Allow",
              "Resource": [
                "arn:aws:dynamodb:*:*:table/wonderland-crons",
                "arn:aws:dynamodb:*:*:table/wonderland-crons-executions",
                "arn:aws:dynamodb:*:*:table/wonderland-crons-locks"
              ]
            },
            {
              "Action": [
                "sqs:ReceiveMessage",
                "sqs:DeleteMessage"
              ],
              "Effect": "Allow",
              "Resource": "arn:aws:sqs:eu-west-1:*:wonderland-service-crons-ECSEventsQueue-*"
            }
          ]
        }
