sudo: required

services:
    - docker

env:
  - TEST_COMMAND="lint"
  - TEST_COMMAND="test push"

before_script: docker login -u "$QUAY_USER_PROD" -p "$QUAY_PASS_PROD" quay.io

script: make $TEST_COMMAND BRANCH=$TRAVIS_BRANCH

deploy:
  provider: script
  script: make notify-jenkins BRANCH=$TRAVIS_BRANCH
  on:
    branch: master
    condition: $TEST_COMMAND = "test push"
